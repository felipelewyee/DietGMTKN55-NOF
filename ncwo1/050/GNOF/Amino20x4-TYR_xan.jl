using DoNOF

mol = """
0 1
N     0.92691    0.61243    1.03892
C     1.14722   -0.73864    0.53123
C     2.61528   -1.12131    0.32368
O     3.04021   -2.17969    0.77879
C     0.32602   -1.03487   -0.73733
C    -1.12309   -0.71134   -0.52519
C    -1.67576    0.47374   -1.02108
C    -1.94181   -1.55542    0.22881
C    -3.00277    0.81051   -0.77310
C    -3.27112   -1.22918    0.48407
C    -3.80418   -0.04084   -0.01478
O    -5.10000    0.33770    0.20047
H     0.49029    0.67950    1.94196
H     0.80343   -1.40647    1.31849
H     0.72326   -0.46073   -1.57162
H     0.46252   -2.09474   -0.95955
H    -1.05805    1.13661   -1.61443
H    -1.54164   -2.48570    0.61498
H    -3.43296    1.72187   -1.16486
H    -3.89441   -1.90006    1.06376
H    -5.53185   -0.35225    0.71475
N     3.33463   -0.25377   -0.41760
H     2.85489    0.56994   -0.76543
C     4.72318   -0.49764   -0.73921
H     4.96784   -1.50333   -0.41161
H     4.88505   -0.41833   -1.81227
H     5.37839    0.20913   -0.23149
C     0.97896    1.75221    0.31030
O     1.44918    1.80195   -0.82875
C     0.38936    2.96750    0.97869
H     0.43571    2.91127    2.06397
H    -0.65597    3.04640    0.68008
H     0.91565    3.85104    0.63244
"""

bset,p = DoNOF.molecule(mol,"def2-qzvp",spherical=true)

p.title = "Amino20x4-TYR_xan"

p.ipnof = 8

p.RI = true
p.maxit = 40

p.maxloop = 10

DoNOF.set_ncwo(p,1)

C = DoNOF.read_C(title=p.title)
n = DoNOF.read_n(title=p.title)

DoNOF.energy(bset,p,C=C,n=n,do_hfidr=false,do_m_diagnostic=true)
