using DoNOF

mol = """
-1 1
H    -0.34175    3.11994    1.77649
O    -0.42760    2.16773    1.93885
C     0.29080    1.83886    3.13794
H    -0.21316    2.25264    4.02040
H     1.31686    2.22685    3.10226
C     0.37262    0.33319    3.24579
H     0.95568    0.07263    4.13811
O    -0.95633   -0.23899    3.35969
C    -1.00734   -1.50358    2.71436
H    -1.30952   -2.28645    3.41056
N    -2.06356   -1.44879    1.66486
C    -2.33811   -0.28543    0.98833
H    -1.75470    0.57572    1.30055
C    -3.28760   -0.20895    0.02211
H    -3.47405    0.72380   -0.49277
C    -4.05945   -1.37511   -0.32988
O    -4.95208   -1.44458   -1.18228
N    -3.68871   -2.52423    0.38708
H    -4.17767   -3.38586    0.15852
C    -2.72657   -2.63946    1.36741
O    -2.46687   -3.70176    1.93027
C     0.98135   -0.36543    2.03179
H     0.66395    0.12088    1.10635
C     0.39436   -1.78175    2.14263
H     0.35321   -2.30807    1.18518
O     1.11786   -2.53898    3.11295
H     2.05199   -2.26666    3.02244
O     2.40245   -0.33806    2.15168
P     3.36193   -0.37555    0.81329
O     3.08372   -1.61967    0.01791
O     4.74671   -0.06256    1.28972
O     2.69746    0.91084    0.03934
C     3.43659    1.49982   -1.05323
H     4.07310    0.74913   -1.53493
H     4.06856    2.30769   -0.66740
C     2.46531    2.06113   -2.07391
H     3.03841    2.61629   -2.82443
O     1.78033    0.96948   -2.76207
C     0.37449    1.09055   -2.61054
H    -0.10398    1.50531   -3.50158
N    -0.17371   -0.27040   -2.44565
C     0.52213   -1.21335   -1.73088
H     1.47823   -0.89490   -1.32851
C     0.06746   -2.47820   -1.54862
H     0.66118   -3.19854   -1.00208
C    -1.19626   -2.87902   -2.10859
O    -1.72775   -3.99212   -2.02193
N    -1.84855   -1.84719   -2.80296
H    -2.75351   -2.07051   -3.20883
C    -1.41821   -0.55102   -3.00988
O    -2.07766    0.27300   -3.63807
C     1.36351    2.95582   -1.49111
H     1.64205    3.38676   -0.52684
C     0.16520    2.00398   -1.38084
H     0.26132    1.41095   -0.46956
O    -1.08180    2.66530   -1.34135
H    -0.96696    3.46331   -1.89574
O     0.96948    3.98781   -2.41378
H     1.43516    4.80574   -2.17860
"""

bset,p = DoNOF.molecule(mol,"def2-qzvp",spherical=true)

p.title = "UPU23-5z"

p.ipnof = 7

p.RI = true
p.maxit = 40

p.maxloop = 10

DoNOF.set_ncwo(p,1)

C = DoNOF.read_C(title=p.title)
n = DoNOF.read_n(title=p.title)

DoNOF.energy(bset,p,C=C,n=n,do_hfidr=false,do_m_diagnostic=true)
