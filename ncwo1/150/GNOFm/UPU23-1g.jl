using DoNOF

mol = """
-1 1
H    -1.37159    4.94358   -2.63650
O    -1.27881    4.47083   -1.79449
C     0.07897    4.61542   -1.35067
H     0.24602    5.61922   -0.93798
H     0.78507    4.45124   -2.17473
C     0.36799    3.57855   -0.29053
H     1.40999    3.70066    0.03381
O    -0.49911    3.76883    0.86787
C    -0.84680    2.51786    1.42858
H    -0.61038    2.49719    2.49398
N    -2.32712    2.32443    1.31398
C    -3.10779    3.10198    0.49797
H    -2.56624    3.84701   -0.07402
C    -4.45354    2.94203    0.41216
H    -5.04447    3.57048   -0.24113
C    -5.11412    1.93367    1.19954
O    -6.32716    1.68961    1.22953
N    -4.23590    1.18104    1.99606
H    -4.64960    0.45143    2.57065
C    -2.86768    1.30757    2.09377
O    -2.17335    0.58385    2.80859
C     0.12834    2.12487   -0.69482
H    -0.77119    2.05081   -1.31435
C    -0.08649    1.43447    0.65351
H    -0.66377    0.50997    0.57751
O     1.15624    1.20451    1.31710
H     1.79037    0.94211    0.62298
O     1.25398    1.61296   -1.41643
P     0.94468    0.60061   -2.67941
O     2.28191    0.28660   -3.27560
O    -0.18520    1.11638   -3.51885
O     0.42013   -0.66455   -1.77008
C    -0.27819   -1.75855   -2.39163
H     0.15821   -1.98958   -3.36976
H    -1.33442   -1.49788   -2.52285
C    -0.17025   -2.96766   -1.48778
H    -0.81367   -3.75964   -1.89183
O     1.20136   -3.45701   -1.46984
C     1.55976   -3.88273   -0.17156
H     1.99132   -4.88403   -0.20681
N     2.62313   -2.97790    0.36818
C     2.88270   -1.75168   -0.18440
H     2.25318   -1.48830   -1.02538
C     3.85066   -0.92711    0.29021
H     4.03925    0.02993   -0.17910
C     4.66088   -1.33489    1.40901
O     5.56235   -0.68234    1.94894
N     4.35173   -2.62060    1.88466
H     4.90661   -2.96709    2.66343
C     3.38174   -3.48286    1.42028
O     3.18791   -4.60125    1.89609
C    -0.52442   -2.73976   -0.01681
H    -0.18359   -1.75155    0.30877
C     0.29300   -3.83696    0.68900
H     0.51347   -3.60900    1.73741
O    -0.36711   -5.09601    0.56740
H    -1.32481   -4.89806    0.59397
O    -1.93316   -2.87866    0.16360
H    -2.17100   -2.50408    1.02876
"""

bset,p = DoNOF.molecule(mol,"def2-qzvp",spherical=true)

p.title = "UPU23-1g"

p.ipnof = 9

p.RI = true
p.gpu = false

p.maxloop = 10

DoNOF.set_ncwo(p,1)

C = DoNOF.read_C(title=p.title)
n = DoNOF.read_n(title=p.title)

DoNOF.energy(bset,p,C=C,n=n,do_hfidr=false,do_m_diagnostic=true)
