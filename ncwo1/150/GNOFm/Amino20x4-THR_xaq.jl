using DoNOF

mol = """
0 1
N    -1.08914   -0.61424   -0.19084
C     0.09784    0.20653   -0.33163
C     1.26616   -0.73070   -0.06691
O     1.16853   -1.64337    0.74963
C     0.09226    1.40311    0.64436
O    -0.76699    2.41907    0.17069
C     1.45270    2.04297    0.83802
H    -0.94714   -1.47525    0.31695
H     0.13774    0.61094   -1.34623
H    -0.25646    1.00637    1.60599
H    -1.48750    1.99532   -0.33156
H     1.32396    2.92814    1.45691
H     1.86303    2.36743   -0.11833
H     2.15552    1.37171    1.32778
N     2.38482   -0.47903   -0.78028
H     2.38503    0.31830   -1.39142
C     3.62126   -1.19460   -0.54355
H     3.37184   -2.13140   -0.05629
H     4.11929   -1.39812   -1.48750
H     4.29388   -0.63125    0.10263
C    -2.30469   -0.27475   -0.66754
O    -2.52670    0.80926   -1.21306
C    -3.38146   -1.31664   -0.51334
H    -4.25299   -0.85034   -0.06210
H    -3.06884   -2.16763    0.08558
H    -3.66781   -1.66279   -1.50427
"""

bset,p = DoNOF.molecule(mol,"def2-qzvp",spherical=true)

p.title = "Amino20x4-THR_xaq"

p.ipnof = 9

p.RI = true
p.gpu = false

p.maxloop = 10

DoNOF.set_ncwo(p,1)

C = DoNOF.read_C(title=p.title)
n = DoNOF.read_n(title=p.title)

DoNOF.energy(bset,p,C=C,n=n,do_hfidr=false,do_m_diagnostic=true)
