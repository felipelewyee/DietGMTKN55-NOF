using DoNOF

mol = """
0 1
N    -1.04932   -0.36461    0.19912
H    -0.81512   -1.23375    0.65349
C     0.05129    0.52612   -0.06345
H    -0.05240    0.91330   -1.07886
C     0.07484    1.69843    0.91827
C     1.32689   -0.29419    0.06576
H     0.89480    2.38076    0.69743
H    -0.86435    2.24069    0.84206
H     0.19463    1.32381    1.93372
O     1.35591   -1.34258    0.70313
C    -2.30806   -0.06860   -0.20936
C    -3.35552   -1.10638    0.11288
H    -3.82918   -1.41919   -0.81448
H    -4.12030   -0.64537    0.73340
H    -2.95273   -1.97650    0.62490
O    -2.57560    0.97325   -0.79992
N     2.41287    0.25498   -0.52634
H     2.28017    1.08128   -1.08221
C     3.72512   -0.35204   -0.45430
H     4.46854    0.38065   -0.14919
H     4.01851   -0.78244   -1.41043
H     3.67518   -1.14423    0.28552
"""

bset,p = DoNOF.molecule(mol,"def2-qzvp",spherical=true)

p.title = "Amino20x4-ALA_xag"

p.ipnof = 9

p.RI = true
p.gpu = false

p.maxloop = 10

DoNOF.set_ncwo(p,1)

C = DoNOF.read_C(title=p.title)
n = DoNOF.read_n(title=p.title)

DoNOF.energy(bset,p,C=C,n=n,do_hfidr=false,do_m_diagnostic=true)
