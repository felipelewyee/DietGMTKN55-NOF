using DoNOF

mol = """
0 1
N     0.19978   -1.00828   -1.84638
H     0.45445   -1.96034   -1.62046
C    -1.17500   -0.73727   -1.91074
O    -1.98959   -1.61985   -1.70333
C    -1.47266    0.64757   -2.23267
H    -2.50230    0.95206   -2.30633
C    -0.46406    1.51938   -2.43534
H    -0.63438    2.55806   -2.67639
N     0.84968    1.14240   -2.34340
H     1.59374    1.80529   -2.48427
C     1.25831   -0.14412   -2.03398
O     2.42636   -0.46530   -1.93835
C     1.06077   -1.02710    1.72852
H     1.51463   -1.11915    0.74053
H     1.60528   -1.69108    2.39771
C     1.11509    0.43886    2.16145
H     2.07338    0.91175    1.95073
H     0.92697    0.52049    3.23467
C    -0.05226    1.05167    1.39068
H     0.22204    1.14045    0.33721
H    -0.33668    2.04281    1.74231
C    -1.16921    0.01410    1.56171
H    -1.89475    0.03771    0.75034
H    -1.71329    0.21879    2.48396
C    -0.44617   -1.35245    1.66537
H    -0.68884   -1.99661    0.82201
H    -0.76128   -1.87985    2.56445
"""

bset,p = DoNOF.molecule(mol,"def2-qzvp",spherical=true)

p.title = "S66-42"

p.ipnof = 7

p.RI = true
p.gpu = false

p.maxloop = 10

DoNOF.set_ncwo(p,1)

C = DoNOF.read_C(title=p.title)
n = DoNOF.read_n(title=p.title)

DoNOF.energy(bset,p,C=C,n=n,do_hfidr=false,do_m_diagnostic=true)
