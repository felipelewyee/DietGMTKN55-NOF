using DoNOF

mol = """
0 1
N    -1.22948   -0.27752    0.40335
C     0.08065   -0.09684   -0.16929
C     1.06862   -0.71245    0.81338
O     0.80534   -0.72694    2.01628
C     0.34671    1.39973   -0.40171
O     1.56065    1.48270   -1.14747
C     0.42912    2.20318    0.88017
H    -1.25250   -0.46743    1.39345
H     0.10559   -0.58536   -1.14262
H    -0.49224    1.74641   -1.01114
H     1.74514    2.41558   -1.29330
H     0.54180    3.26206    0.64522
H     1.27842    1.88503    1.48119
H    -0.47852    2.08596    1.46900
N     2.22538   -1.20705    0.32480
H     2.80573   -1.62391    1.03618
C     2.57504   -1.42691   -1.06766
H     2.33761   -0.54929   -1.65678
H     3.64767   -1.58965   -1.12364
H     2.07208   -2.30133   -1.48174
C    -2.34290   -0.32163   -0.37314
O    -2.30325   -0.15227   -1.58708
C    -3.63227   -0.59360    0.36320
H    -4.05311   -1.52422   -0.01079
H    -4.33647    0.20205    0.13361
H    -3.50357   -0.66432    1.44027
"""

bset,p = DoNOF.molecule(mol,"def2-qzvp",spherical=true)

p.title = "Amino20x4-THR_xal"

p.ipnof = 7
p.ista = 1

p.RI = true
p.gpu = false

p.maxloop = 10

DoNOF.set_ncwo(p,1)

C = DoNOF.read_C(title=p.title)
n = DoNOF.read_n(title=p.title)

DoNOF.energy(bset,p,C=C,n=n,do_hfidr=false,do_m_diagnostic=true)
