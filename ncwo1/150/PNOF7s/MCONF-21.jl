using DoNOF

mol = """
0 1
N    -1.15251    2.97951   -0.08447
C     0.14986    2.64090    0.21849
C     0.25222    1.28313    0.41488
C    -1.06827    0.74916    0.21970
C    -1.60092   -0.54672    0.28738
C    -2.95732   -0.73201    0.04865
C    -3.79621    0.36273   -0.25811
C    -3.28538    1.65500   -0.32735
C    -1.92338    1.83841   -0.08804
H    -1.48507    3.91089   -0.25203
H     0.91652    3.39693    0.27380
H    -0.98923   -1.40729    0.52488
H    -4.84856    0.21265   -0.44263
H    -3.93851    2.48596   -0.56104
O    -3.40298   -2.02828    0.13287
C    -4.78287   -2.24945   -0.09997
H    -5.40216   -1.71879    0.62664
H    -5.07246   -1.94912   -1.10946
H    -4.93591   -3.31869    0.01278
C     1.49675    0.50734    0.70898
C     2.02633   -0.19950   -0.54702
N     3.22200   -0.98609   -0.29081
C     4.44674   -0.39853   -0.18497
C     5.59245   -1.32975    0.15794
H     2.27819    1.16922    1.08318
H     1.30042   -0.24064    1.48220
H     1.26432   -0.86017   -0.96017
H     2.27181    0.54852   -1.29904
H     3.13185   -1.95921   -0.06335
O     4.61605    0.80091   -0.35927
H     5.99052   -1.04750    1.13116
H     5.30347   -2.37900    0.18103
H     6.38226   -1.19053   -0.57683
"""

bset,p = DoNOF.molecule(mol,"def2-qzvp",spherical=true)

p.title = "MCONF-21"

p.ipnof = 7
p.ista = 1

p.RI = true
p.gpu = false

p.maxloop = 10

DoNOF.set_ncwo(p,1)

C = DoNOF.read_C(title=p.title)
n = DoNOF.read_n(title=p.title)

DoNOF.energy(bset,p,C=C,n=n,do_hfidr=false,do_m_diagnostic=true)
