using DoNOF

mol = """
0 1
N     1.20723   -0.35669   -0.45402
C     0.05991   -0.25255    0.41418
C    -1.03848   -1.12713   -0.18074
O    -0.98970   -1.53243   -1.33866
C    -0.42891    1.20153    0.58078
C    -0.91965    1.77293   -0.74830
C     0.67393    2.04925    1.20424
C    -1.49134    3.18071   -0.62895
H     0.99381   -0.69029   -1.38370
H     0.35574   -0.63303    1.39517
H    -1.27873    1.17242    1.27186
H    -1.68249    1.11344   -1.16718
H    -0.08582    1.77037   -1.45442
H     1.06601    1.58260    2.10596
H     1.50362    2.16000    0.50585
H     0.30713    3.04175    1.45814
H    -2.28341    3.21553    0.12020
H    -1.91633    3.50709   -1.57674
H    -0.72990    3.90358   -0.34374
N    -2.08223   -1.36428    0.64775
H    -2.00171   -1.07083    1.60539
C    -3.22639   -2.15267    0.24012
H    -3.16658   -3.17391    0.61438
H    -4.14416   -1.69352    0.59864
H    -3.23532   -2.18082   -0.84462
C     2.45593   -0.56781    0.05439
O     2.71151   -0.47525    1.24881
C     3.51311   -0.90130   -0.97059
H     3.88903   -1.90152   -0.76627
H     4.34134   -0.20742   -0.85181
H     3.14603   -0.85559   -1.99264
"""

bset,p = DoNOF.molecule(mol,"def2-qzvp",spherical=true)

p.title = "Amino20x4-ILE_xag"

p.ipnof = 5

p.RI = true
p.gpu = false

p.maxloop = 10

DoNOF.set_ncwo(p,1)

C = DoNOF.read_C(title=p.title)
n = DoNOF.read_n(title=p.title)

DoNOF.energy(bset,p,C=C,n=n,do_hfidr=false,do_m_diagnostic=true)
