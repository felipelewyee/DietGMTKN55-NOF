using DoNOF

mol = """
0 1
N     0.13299    0.89734   -0.55346
C    -0.08501   -0.37288    0.12460
C     1.08917   -1.31700   -0.16402
O     1.01131   -2.24619   -0.96042
C    -1.40553   -0.98338   -0.30452
C    -2.62225   -0.08866   -0.07491
C    -3.88352   -0.82659   -0.51002
C    -2.73759    0.35459    1.37933
H    -0.20566    0.99984   -1.49559
H    -0.08638   -0.14730    1.19059
H    -1.53488   -1.91771    0.24694
H    -1.33156   -1.26854   -1.35634
H    -2.52097    0.80643   -0.69510
H    -4.03596   -1.71104    0.11071
H    -4.76439   -0.19285   -0.41166
H    -3.81356   -1.15478   -1.54695
H    -2.76403   -0.51543    2.03874
H    -3.65597    0.91963    1.53742
H    -1.90375    0.98572    1.68468
N     2.20268   -1.00296    0.53817
H     2.18789   -0.12686    1.04553
C     3.45369   -1.69095    0.30429
H     4.04072   -1.70003    1.21846
H     3.23144   -2.71075    0.00570
H     4.03695   -1.22103   -0.48838
C     0.88614    1.88563   -0.01182
O     1.43332    1.76928    1.08532
C     0.99878    3.14896   -0.82615
H     2.05174    3.35901   -0.99700
H     0.58861    3.97037   -0.24321
H     0.48064    3.09326   -1.78020
"""

bset,p = DoNOF.molecule(mol,"def2-qzvp",spherical=true)

p.title = "Amino20x4-LEU_xad"

p.ipnof = 5

p.RI = true
p.gpu = false

p.maxloop = 10

DoNOF.set_ncwo(p,1)

C = DoNOF.read_C(title=p.title)
n = DoNOF.read_n(title=p.title)

DoNOF.energy(bset,p,C=C,n=n,do_hfidr=false,do_m_diagnostic=true)
