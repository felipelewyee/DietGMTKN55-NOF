using DoNOF

mol = """
-1 1
H    -4.91259   -1.98165    0.53500
O    -4.19835   -1.47050    0.12207
C    -4.13326   -1.84326   -1.26238
H    -5.09482   -1.66569   -1.76001
H    -3.86975   -2.90394   -1.37514
C    -3.05609   -1.02687   -1.93744
H    -2.99015   -1.34565   -2.98563
O    -3.39090    0.38667   -1.90785
C    -2.23296    1.17130   -1.70926
H    -2.14815    1.93115   -2.48914
N    -2.37560    1.91019   -0.41270
C    -3.39329    1.64551    0.46976
H    -4.02655    0.81173    0.19101
C    -3.57891    2.36651    1.60389
H    -4.39188    2.13399    2.27853
C    -2.69506    3.45645    1.92488
O    -2.76197    4.20528    2.90489
N    -1.65290    3.61925    0.99379
H    -0.99286    4.37216    1.17055
C    -1.43332    2.90114   -0.16338
O    -0.51381    3.14909   -0.94384
C    -1.66267   -1.11391   -1.30960
H    -1.71751   -1.19900   -0.22081
C    -1.03009    0.21538   -1.74517
H    -0.20462    0.54836   -1.11101
O    -0.60827    0.13026   -3.11110
H    -0.48243   -0.82103   -3.29723
O    -0.98617   -2.24782   -1.86148
P     0.03186   -3.16153   -0.92571
O     0.35202   -4.34295   -1.78777
O    -0.52823   -3.27795    0.45719
O     1.34794   -2.20493   -0.75365
C     2.10685   -1.77788   -1.90137
H     1.46791   -1.20916   -2.58307
H     2.51482   -2.64673   -2.43051
C     3.23415   -0.88930   -1.41244
H     3.79660   -0.52659   -2.27871
O     2.66384    0.26886   -0.72577
C     3.15555    0.34133    0.60954
H     3.92878    1.10598    0.71245
N     2.06138    0.75310    1.49593
C     0.92309   -0.01826    1.56420
H     0.91922   -0.87515    0.89749
C    -0.11372    0.27147    2.38476
H    -0.99048   -0.36119    2.42018
C    -0.04564    1.42700    3.24592
O    -0.90142    1.79638    4.05375
N     1.13355    2.17538    3.08649
H     1.22650    3.00669    3.66496
C     2.20438    1.91662    2.25451
O     3.19925    2.63717    2.21586
C     4.19598   -1.55615   -0.41859
H     4.17820   -2.64516   -0.49269
C     3.70543   -1.06092    0.94693
H     2.89119   -1.70124    1.29488
O     4.71327   -1.05235    1.94084
H     5.54792   -0.89774    1.45076
O     5.54132   -1.06633   -0.58185
H     6.07340   -1.76358   -0.99572
"""

bset,p = DoNOF.molecule(mol,"def2-qzvp",spherical=true)

p.title = "UPU23-1b"

p.ipnof = 5

p.RI = true
p.gpu = false

p.maxloop = 10

DoNOF.set_ncwo(p,1)

C = DoNOF.read_C(title=p.title)
n = DoNOF.read_n(title=p.title)

DoNOF.energy(bset,p,C=C,n=n,do_hfidr=false,do_m_diagnostic=true)
