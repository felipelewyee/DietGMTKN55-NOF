using DoNOF

mol = """
-1 1
H    -0.99840   -3.34937   -3.37113
O    -0.31555   -2.95922   -2.80287
C     0.19851   -3.99603   -1.95327
H     0.62565   -4.81187   -2.55042
H    -0.58927   -4.40509   -1.30617
C     1.26098   -3.40204   -1.05728
H     1.65247   -4.19844   -0.41057
O     2.35196   -2.85338   -1.84131
C     2.90855   -1.72621   -1.18788
H     3.97089   -1.87493   -0.98911
N     2.80151   -0.54915   -2.09732
C     1.89068   -0.50208   -3.12453
H     1.27855   -1.39225   -3.22983
C     1.77532    0.57572   -3.93991
H     1.04288    0.59233   -4.73519
C     2.61850    1.72735   -3.74261
O     2.62935    2.76311   -4.41777
N     3.48572    1.60665   -2.64308
H     4.08627    2.40279   -2.44369
C     3.62298    0.53181   -1.79193
O     4.39935    0.52120   -0.83610
C     0.80028   -2.23569   -0.18509
H     0.10196   -1.59830   -0.73573
C     2.11739   -1.50574    0.11311
H     1.98469   -0.43985    0.32727
O     2.80851   -2.15444    1.18031
H     2.11211   -2.51894    1.76241
O     0.19000   -2.71613    1.01974
P    -1.26737   -2.06137    1.45277
O    -1.64736   -2.80625    2.69589
O    -2.17063   -1.94989    0.26482
O    -0.86325   -0.52108    1.79957
C    -0.04648   -0.15185    2.92654
H     0.97268    0.05093    2.58348
H    -0.03743   -0.95239    3.67433
C    -0.67951    1.10070    3.50636
H    -0.13147    1.41283    4.40006
O    -0.60891    2.20201    2.55868
C    -1.87549    2.41053    1.93483
H    -2.18692    3.43612    2.14213
N    -1.72803    2.36033    0.46092
C    -1.97947    1.24563   -0.30660
H    -2.32064    0.36135    0.21386
C    -1.79511    1.21429   -1.64974
H    -2.01147    0.31386   -2.20895
C    -1.30815    2.37665   -2.34386
O    -1.12435    2.49845   -3.55900
N    -1.00889    3.44669   -1.48286
H    -0.63318    4.28808   -1.91264
C    -1.17058    3.50885   -0.11548
O    -0.84780    4.49694    0.54131
C    -2.16384    0.90943    3.82447
H    -2.40462   -0.13869    4.01154
C    -2.89471    1.43117    2.55734
H    -3.11666    0.59252    1.90062
O    -4.13009    2.06221    2.86286
H    -4.00369    2.44868    3.75491
O    -2.53206    1.71006    4.96253
H    -3.09634    1.17134    5.53927
"""

bset,p = DoNOF.molecule(mol,"def2-qzvp",spherical=true)

p.title = "UPU23-1p"

p.ipnof = 5

p.RI = true
p.maxit = 40

p.maxloop = 10

DoNOF.set_ncwo(p,1)

C = DoNOF.read_C(title=p.title)
n = DoNOF.read_n(title=p.title)

DoNOF.energy(bset,p,C=C,n=n,do_hfidr=false,do_m_diagnostic=true)
