using DoNOF

mol = """
0 1
H     7.06298   -1.63698    0.55059
C     6.83975   -0.85495   -0.17910
H     6.63952   -1.31642   -1.15039
H     7.72769   -0.22241   -0.26245
C     5.68839   -0.01111    0.34823
O     5.73948    0.54727    1.44028
N     4.60714    0.08446   -0.47815
H     4.56234   -0.41929   -1.35335
C     3.40569    0.81499   -0.10917
H     3.41073    0.89334    0.98240
C     3.37046    2.22527   -0.72227
H     3.38045    2.16388   -1.81428
H     2.46827    2.76387   -0.41282
H     4.24350    2.78978   -0.38699
C     2.21122   -0.01032   -0.60317
O     2.21310   -0.50849   -1.72781
N     1.18562   -0.15245    0.27564
H     1.20147    0.30395    1.17902
C    -0.07068   -0.79255   -0.07695
H    -0.15454   -0.79169   -1.16678
C    -0.10521   -2.24635    0.41243
H     0.73415   -2.78313   -0.05176
H     0.03264   -2.25531    1.50314
O    -1.36444   -2.78206    0.03062
H    -1.39994   -3.70421    0.31059
C    -1.19138    0.02307    0.58385
O    -1.05828    0.42168    1.74289
N    -2.26595    0.29884   -0.18741
H    -2.37477   -0.13248   -1.09682
C    -3.43468    1.00041    0.32705
H    -3.41305    0.89464    1.41646
C    -3.41344    2.49177   -0.04404
H    -3.42103    2.60757   -1.13073
H    -4.28712    3.00750    0.36778
H    -2.51124    2.95768    0.36021
C    -4.66746    0.31774   -0.28282
O    -4.69549    0.04215   -1.47907
N    -5.68639    0.06322    0.57935
H    -5.55766    0.28687    1.55511
C    -6.93900   -0.54238    0.15698
H    -7.10137   -1.50148    0.66149
H    -7.78746    0.11699    0.36654
H    -6.87214   -0.71153   -0.91702
"""

bset,p = DoNOF.molecule(mol,"def2-qzvp",spherical=true)

p.title = "PCONF21-SER_ab"

p.ipnof = 8

p.RI = true
p.maxit = 40

p.maxloop = 10

DoNOF.set_ncwo(p,1)

C = DoNOF.read_C(title=p.title)
n = DoNOF.read_n(title=p.title)

DoNOF.energy(bset,p,C=C,n=n,do_hfidr=false,do_m_diagnostic=true)
