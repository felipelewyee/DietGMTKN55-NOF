using DoNOF

mol = """
0 1
N    -1.58958   -0.43645   -0.41979
C    -1.23039    0.57236    0.53729
C    -0.75745    1.77814   -0.26618
O    -0.50857    1.70621   -1.46502
C    -0.13070    0.09131    1.51541
C     1.06905   -0.42919    0.78448
C     2.07238    0.43296    0.33133
C     1.17219   -1.79262    0.49218
C     3.15318   -0.05456   -0.39918
C     2.25188   -2.28466   -0.23813
C     3.24336   -1.41503   -0.68877
H    -1.25673   -0.27640   -1.35935
H    -2.10925    0.84174    1.12901
H    -0.57381   -0.69273    2.12690
H     0.14438    0.92079    2.16910
H     2.00722    1.49069    0.55680
H     0.40602   -2.46731    0.85505
H     3.92276    0.62427   -0.74091
H     2.32113   -3.34297   -0.45108
H     4.08298   -1.79480   -1.25467
N    -0.58307    2.91354    0.45036
H    -0.92452    2.94507    1.39457
C    -0.14338    4.13613   -0.19132
H     0.24611    4.81351    0.56276
H     0.64185    3.89426   -0.90151
H    -0.95290    4.62478   -0.73270
C    -2.18690   -1.59728   -0.05806
O    -2.53167   -1.82785    1.09821
C    -2.37208   -2.59573   -1.17441
H    -3.33063   -3.08963   -1.04628
H    -1.58984   -3.34980   -1.09684
H    -2.31894   -2.13965   -2.15996
"""

bset,p = DoNOF.molecule(mol,"def2-qzvp",spherical=true)

p.title = "Amino20x4-PHE_xal"

p.ipnof = 7

p.RI = true
p.maxit = 40

p.maxloop = 10

DoNOF.set_ncwo(p,1)

C = DoNOF.read_C(title=p.title)
n = DoNOF.read_n(title=p.title)

DoNOF.energy(bset,p,C=C,n=n,do_hfidr=false,do_m_diagnostic=true)
