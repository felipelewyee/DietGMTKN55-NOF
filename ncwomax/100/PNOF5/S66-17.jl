using DoNOF

mol = """
0 1
N    -1.48443    1.16173    0.00093
H    -0.45601    1.21297    0.00164
C    -2.05125   -0.10146    0.00152
O    -1.34853   -1.11455    0.00265
C    -3.49805   -0.12337    0.00050
H    -4.00402   -1.07287    0.00085
C    -4.17645    1.04305   -0.00091
H    -5.25533    1.08975   -0.00173
N    -3.52927    2.24437   -0.00140
H    -4.03827    3.11284   -0.00247
C    -2.14591    2.37598   -0.00051
O    -1.59427    3.45600   -0.00098
N     3.38940    0.05326    0.00052
H     3.83664    0.95983    0.00090
C     4.24545   -1.06136   -0.00098
O     5.45490   -0.90965   -0.00173
C     3.53123   -2.32353   -0.00149
H     4.09782   -3.23856   -0.00263
C     2.18106   -2.32735   -0.00053
H     1.60410   -3.24031   -0.00085
N     1.44307   -1.17647    0.00092
H     0.41673   -1.19791    0.00160
C     2.01584    0.06820    0.00147
O     1.36552    1.10941    0.00271
"""

bset,p = DoNOF.molecule(mol,"def2-qzvp",spherical=true)

p.title = "S66-17"

p.ipnof = 5

p.RI = true
p.maxit = 40

p.maxloop = 10

#DoNOF.set_ncwo(p,1)

C = DoNOF.read_C(title=p.title)
n = DoNOF.read_n(title=p.title)

DoNOF.energy(bset,p,C=C,n=n,do_hfidr=false,do_m_diagnostic=true)
