using DoNOF

mol = """
0 1
N     1.70428   -1.06028    0.58746
C     0.40165   -0.43763    0.39911
C     0.56854    1.08447    0.44180
O     0.37464    1.74162    1.45992
C    -0.56888   -0.93009    1.45695
C    -1.97159   -0.34536    1.30725
H     2.00335   -1.27012    1.52506
H     0.07198   -0.73238   -0.59638
H    -0.60964   -2.01971    1.38940
H    -1.94021    0.71624    1.55293
H    -2.62157   -0.82109    2.04525
N     0.96828    1.61348   -0.73868
H     1.32196    0.95482   -1.42197
C     1.34133    3.01021   -0.82255
H     2.32963    3.19588   -0.40035
H     0.62032    3.59883   -0.26343
H     1.33332    3.32006   -1.86329
C     2.57664   -1.21147   -0.43972
O     2.31205   -0.84748   -1.58578
C     3.88938   -1.86823   -0.09751
H     4.69480   -1.17639   -0.33258
H     4.01085   -2.74325   -0.73124
H     3.96226   -2.16603    0.94532
H    -0.17404   -0.66618    2.44009
C    -2.57526   -0.53308   -0.07999
H    -2.50049   -1.58268   -0.38328
H    -2.01653    0.04937   -0.81756
C    -4.03716   -0.10132   -0.13415
H    -4.61411   -0.69362    0.57855
H    -4.11609    0.93627    0.19521
N    -4.68791   -0.20938   -1.43815
H    -4.18008    0.34925   -2.11367
H    -4.62172   -1.16478   -1.76859
"""

bset,p = DoNOF.molecule(mol,"def2-qzvp",spherical=true)

p.title = "Amino20x4-LYS_xat"

p.ipnof = 7

p.RI = true
p.maxit = 40

p.maxloop = 10

#DoNOF.set_ncwo(p,1)

C = DoNOF.read_C(title=p.title)
n = DoNOF.read_n(title=p.title)

DoNOF.energy(bset,p,C=C,n=n,do_hfidr=false,do_m_diagnostic=true)
