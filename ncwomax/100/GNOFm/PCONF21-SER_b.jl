using DoNOF

mol = """
0 1
H     6.49240   -1.96151   -0.26733
C     6.48353   -0.88386   -0.44538
H     6.44583   -0.69796   -1.52177
H     7.41922   -0.48004   -0.04803
C     5.32506   -0.27256    0.32656
O     5.20448   -0.41832    1.53770
N     4.44636    0.46277   -0.42307
H     4.52636    0.47748   -1.43047
C     3.24966    1.07301    0.14304
H     3.26040    0.80139    1.20192
C     3.25414    2.59646   -0.01942
H     3.23840    2.86309   -1.07937
H     2.37118    3.03797    0.45352
H     4.14720    3.01989    0.44657
C     2.03738    0.46304   -0.57973
O     1.86794    0.64617   -1.78141
N     1.22722   -0.32124    0.18503
H     1.36623   -0.35850    1.18668
C    -0.00579   -0.91053   -0.31717
H    -0.09251   -0.61424   -1.36512
C     0.03340   -2.43578   -0.21301
H     0.86644   -2.81470   -0.82247
H     0.21408   -2.70793    0.83584
O    -1.22752   -2.91003   -0.66680
H    -1.29365   -3.84853   -0.44959
C    -1.16068   -0.35781    0.53563
O    -1.20013   -0.59435    1.74152
N    -2.03588    0.45645   -0.10647
H    -2.00698    0.52910   -1.11443
C    -3.19096    1.05580    0.56020
H    -3.14623    0.70370    1.59431
C    -3.13481    2.58510    0.51257
H    -3.18853    2.92921   -0.52264
H    -3.98032    3.01726    1.05812
H    -2.20671    2.94381    0.96609
C    -4.45138    0.54569   -0.15834
O    -4.67483    0.86404   -1.32306
N    -5.25468   -0.27195    0.57372
H    -4.94675   -0.54344    1.49580
C    -6.44892   -0.89125    0.02370
H    -6.32080   -1.97295   -0.09510
H    -7.31544   -0.70507    0.66662
H    -6.62349   -0.44738   -0.95684
"""

bset,p = DoNOF.molecule(mol,"def2-qzvp",spherical=true)

p.title = "PCONF21-SER_b"

p.ipnof = 9

p.RI = true
p.maxit = 40

p.maxloop = 10

#DoNOF.set_ncwo(p,1)

C = DoNOF.read_C(title=p.title)
n = DoNOF.read_n(title=p.title)

DoNOF.energy(bset,p,C=C,n=n,do_hfidr=false,do_m_diagnostic=true)
