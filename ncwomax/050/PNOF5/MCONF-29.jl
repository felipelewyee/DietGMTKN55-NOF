using DoNOF

mol = """
0 1
N    -0.30967    2.29547   -0.58406
C     0.72785    1.43978   -0.89038
C     0.32747    0.13287   -0.70864
C    -1.03582    0.19223   -0.26053
C    -1.97950   -0.79315    0.08630
C    -3.23641   -0.38652    0.49849
C    -3.58357    0.98117    0.57211
C    -2.67431    1.96885    0.22819
C    -1.40266    1.55896   -0.19082
H    -0.25896    3.29728   -0.61168
H     1.67715    1.83166   -1.21725
H    -1.74581   -1.84910    0.05077
H    -4.57237    1.24538    0.92214
H    -2.94122    3.01581    0.29263
O    -4.16156   -1.33890    0.88782
C    -5.14662   -1.58216   -0.11326
H    -4.68372   -1.96045   -1.02786
H    -5.70622   -0.67389   -0.34764
H    -5.82390   -2.33051    0.28977
C     1.11989   -1.11769   -0.96471
C     2.62329   -0.88316   -1.05575
N     3.12667   -0.35883    0.20311
C     4.46093   -0.30843    0.46960
C     4.83784    0.31300    1.79997
H     0.78668   -1.58337   -1.89603
H     0.92280   -1.84021   -0.16805
H     2.85581   -0.19934   -1.87732
H     3.14321   -1.81595   -1.26640
H     2.48130    0.11351    0.81157
O     5.30065   -0.74752   -0.30438
H     5.38333   -0.42522    2.38453
H     3.97908    0.65845    2.37284
H     5.50838    1.14997    1.61499
"""

bset,p = DoNOF.molecule(mol,"def2-qzvp",spherical=true)

p.title = "MCONF-29"

p.ipnof = 5

p.RI = true
p.maxit = 40

p.maxloop = 10

#DoNOF.set_ncwo(p,1)

C = DoNOF.read_C(title=p.title)
n = DoNOF.read_n(title=p.title)

DoNOF.energy(bset,p,C=C,n=n,do_hfidr=false,do_m_diagnostic=true)
