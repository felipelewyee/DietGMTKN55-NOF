using DoNOF

mol = """
-1 1
H    -2.80046   -1.43976    2.79369
O    -2.66581   -1.10811    1.89154
C    -2.57946   -2.23922    1.00495
H    -3.46948   -2.87354    1.09875
H    -1.68807   -2.84166    1.22604
C    -2.47105   -1.72735   -0.41735
H    -2.26439   -2.57562   -1.07617
O    -3.73685   -1.13182   -0.84138
C    -3.54573    0.23165   -1.20432
H    -3.54228    0.36211   -2.28942
N    -4.69289    0.99888   -0.70695
C    -4.99862    0.94244    0.63323
H    -4.34210    0.30266    1.21795
C    -6.04329    1.61164    1.17477
H    -6.25724    1.54294    2.23279
C    -6.89177    2.41974    0.33370
O    -7.86961    3.08447    0.69567
N    -6.52716    2.39612   -1.02075
H    -7.10135    2.94169   -1.65864
C    -5.47378    1.72466   -1.60765
O    -5.25430    1.76713   -2.81634
C    -1.39945   -0.65022   -0.61870
H    -0.62081   -0.68203    0.14621
C    -2.19661    0.66042   -0.59057
H    -2.34024    0.97237    0.44610
O    -1.58148    1.73639   -1.27668
H    -1.17335    1.34386   -2.07300
O    -0.82010   -0.75475   -1.93561
P     0.63574   -1.52533   -2.05811
O     0.91860   -1.56887   -3.52865
O     0.63046   -2.74288   -1.18608
O     1.65700   -0.48962   -1.31082
C     1.95362    0.79727   -1.89359
H     1.24447    1.53804   -1.50986
H     1.87633    0.74065   -2.98487
C     3.37033    1.17531   -1.50595
H     3.62738    2.13044   -1.97503
O     3.46721    1.35218   -0.05849
C     4.36411    0.38659    0.49460
H     5.31528    0.85388    0.76019
N     3.80556   -0.10375    1.75729
C     2.64962   -0.85266    1.75172
H     2.23009   -1.03219    0.76704
C     2.06607   -1.31048    2.88405
H     1.16181   -1.90359    2.84650
C     2.64489   -0.99591    4.16722
O     2.21897   -1.34744    5.27318
N     3.78595   -0.18364    4.08598
H     4.21440    0.09242    4.96647
C     4.40783    0.29987    2.95347
O     5.39232    1.03374    3.00493
C     4.40666    0.10671   -1.87833
H     4.07028   -0.52165   -2.70520
C     4.58357   -0.69631   -0.57916
H     3.81441   -1.46794   -0.51775
O     5.84714   -1.32965   -0.47956
H     6.45967   -0.74835   -0.97737
O     5.68305    0.70043   -2.18746
H     5.84493    0.59765   -3.13824
"""

bset,p = DoNOF.molecule(mol,"def2-qzvp",spherical=true)

p.title = "UPU23-2p"

p.ipnof = 8

p.RI = true
p.maxit = 40

p.maxloop = 10

#DoNOF.set_ncwo(p,1)

C = DoNOF.read_C(title=p.title)
n = DoNOF.read_n(title=p.title)

p.orb_method="YOGI"
DoNOF.energy(bset,p,C=C,n=n,do_hfidr=false,do_m_diagnostic=true)
